{{ 'section-reviews.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  .customerreview-section-{{ section.id }} {
    background-color: {{ section.settings.background_color }};
  }

  .customerreview-section-{{ section.id }} .review-badge {
    background-color: {{ section.settings.badge_bg_color }};
    color: {{ section.settings.badge_text_color }};
  }

  .customerreview-section-{{ section.id }} .review-heading {
    color: {{ section.settings.heading_color }};
    font-size: {{ section.settings.heading_size }}px;
    font-weight: {{ section.settings.heading_weight }};
  }

  .customerreview-section-{{ section.id }} .review-description {
    color: {{ section.settings.description_color }};
    font-size: {{ section.settings.description_size }}px;
  }

  .customerreview-section-{{ section.id }} .review-stars svg {
    fill: {{ section.settings.star_color }};
  }

  .customerreview-section-{{ section.id }} .review-quote-icon {
    color: {{ section.settings.quote_icon_color }};
  }

  .customerreview-section-{{ section.id }} .review-text {
    font-size: {{ section.settings.review_text_size }}px;
    color: {{ section.settings.review_text_color }};
  }

  .customerreview-section-{{ section.id }} .review-name {
    font-weight: {{ section.settings.name_weight }};
    color: {{ section.settings.name_color }};
  }

  .customerreview-section-{{ section.id }} .review-location {
    color: {{ section.settings.location_color }};
  }

  .customerreview-section-{{ section.id }} .review-service-badge {
    background-color: {{ section.settings.service_badge_bg }};
    color: {{ section.settings.service_badge_color }};
  }
{%- endstyle -%}

<section class="customerreview-section-{{ section.id }} color-{{ section.settings.color_scheme }} gradient">
  <div class="{{ section.settings.container_width }} section-{{ section.id }}-padding">
    <div class="customerreview-container">
      {%- if section.settings.show_badge and section.settings.badge_text != blank -%}
        <div class="review-badge-wrapper" style="text-align: center; margin-bottom: 16px;">
          <span class="review-badge" style="display: inline-block; padding: 8px 16px; border-radius: 20px; font-size: 14px;">
            {{ section.settings.badge_text }}
          </span>
        </div>
      {%- endif -%}

      {%- if section.settings.heading != blank -%}
        <h2 class="review-heading" style="text-align: center; margin-bottom: 16px;">
          {{ section.settings.heading }}
        </h2>
      {%- endif -%}

      {%- if section.settings.description != blank -%}
        <p class="review-description" style="text-align: center; margin-bottom: 40px; max-width: 600px; margin-left: auto; margin-right: auto;">
          {{ section.settings.description }}
        </p>
      {%- endif -%}

      {%- if section.blocks.size > 0 -%}
        <div class="reviews-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px;">
          {%- for block in section.blocks -%}
            {%- case block.type -%}
              {%- when 'review' -%}
                <div class="review-card" {{ block.shopify_attributes }} style="background: #fff; padding: 24px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                  <div class="review-stars" style="display: flex; gap: 4px; margin-bottom: 16px;">
                    {%- for i in (1..5) -%}
                      {%- if i <= block.settings.rating -%}
                        <svg width="20" height="20" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                      {%- else -%}
                        <svg width="20" height="20" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="fill: #e0e0e0;">
                          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                      {%- endif -%}
                    {%- endfor -%}
                  </div>

                  {%- if section.settings.quote_icon != blank -%}
                    <span class="review-quote-icon" style="font-size: 48px; line-height: 1; display: block; margin-bottom: 8px;">
                      {{ section.settings.quote_icon }}
                    </span>
                  {%- endif -%}

                  {%- if block.settings.review_text != blank -%}
                    <p class="review-text" style="margin-bottom: 16px; line-height: 1.6;">
                      {{ block.settings.review_text }}
                    </p>
                  {%- endif -%}

                  <div class="review-author" style="display: flex; align-items: center; gap: 12px; flex-wrap: wrap;">
                    <div>
                      {%- if block.settings.customer_name != blank -%}
                        <span class="review-name" style="display: block;">{{ block.settings.customer_name }}</span>
                      {%- endif -%}
                      {%- if block.settings.customer_location != blank -%}
                        <span class="review-location" style="font-size: 14px;">{{ block.settings.customer_location }}</span>
                      {%- endif -%}
                    </div>
                    {%- if block.settings.service_type != blank -%}
                      <span class="review-service-badge" style="padding: 4px 12px; border-radius: 16px; font-size: 12px; margin-left: auto;">
                        {{ block.settings.service_type }}
                      </span>
                    {%- endif -%}
                  </div>
                </div>
            {%- endcase -%}
          {%- endfor -%}
        </div>
      {%- endif -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Customer Reviews",
  "tag": "section",
  "class": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "select",
      "id": "container_width",
      "options": [
        {
          "value": "page-width",
          "label": "Page width"
        },
        {
          "value": "page-width--narrow",
          "label": "Narrow"
        }
      ],
      "default": "page-width",
      "label": "Container width"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "color",
      "id": "background_color",
      "default": "#f8f9fa",
      "label": "Background color"
    },
    {
      "type": "header",
      "content": "Badge"
    },
    {
      "type": "checkbox",
      "id": "show_badge",
      "default": true,
      "label": "Show badge"
    },
    {
      "type": "text",
      "id": "badge_text",
      "default": "Customer Reviews",
      "label": "Badge text"
    },
    {
      "type": "color",
      "id": "badge_bg_color",
      "default": "#007bff",
      "label": "Badge background color"
    },
    {
      "type": "color",
      "id": "badge_text_color",
      "default": "#ffffff",
      "label": "Badge text color"
    },
    {
      "type": "header",
      "content": "Heading"
    },
    {
      "type": "text",
      "id": "heading",
      "default": "What Our Customers Say",
      "label": "Heading"
    },
    {
      "type": "color",
      "id": "heading_color",
      "default": "#1a2332",
      "label": "Heading color"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 20,
      "max": 60,
      "step": 2,
      "unit": "px",
      "default": 36,
      "label": "Heading size"
    },
    {
      "type": "text",
      "id": "heading_weight",
      "default": "700",
      "label": "Heading weight"
    },
    {
      "type": "header",
      "content": "Description"
    },
    {
      "type": "textarea",
      "id": "description",
      "default": "Don't just take our word for it. Here's what our satisfied customers have to say about our products.",
      "label": "Description"
    },
    {
      "type": "color",
      "id": "description_color",
      "default": "#666666",
      "label": "Description color"
    },
    {
      "type": "range",
      "id": "description_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 16,
      "label": "Description size"
    },
    {
      "type": "header",
      "content": "Review Styling"
    },
    {
      "type": "color",
      "id": "star_color",
      "default": "#fbbf24",
      "label": "Star color"
    },
    {
      "type": "text",
      "id": "quote_icon",
      "default": "\"",
      "label": "Quote icon"
    },
    {
      "type": "color",
      "id": "quote_icon_color",
      "default": "#e5e7eb",
      "label": "Quote icon color"
    },
    {
      "type": "range",
      "id": "review_text_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 15,
      "label": "Review text size"
    },
    {
      "type": "color",
      "id": "review_text_color",
      "default": "#333333",
      "label": "Review text color"
    },
    {
      "type": "text",
      "id": "name_weight",
      "default": "600",
      "label": "Name font weight"
    },
    {
      "type": "color",
      "id": "name_color",
      "default": "#1a2332",
      "label": "Name color"
    },
    {
      "type": "color",
      "id": "location_color",
      "default": "#666666",
      "label": "Location color"
    },
    {
      "type": "color",
      "id": "service_badge_bg",
      "default": "#e3f2fd",
      "label": "Service badge background"
    },
    {
      "type": "color",
      "id": "service_badge_color",
      "default": "#1976d2",
      "label": "Service badge text color"
    },
    {
      "type": "header",
      "content": "Section padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 80
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 80
    }
  ],
  "blocks": [
    {
      "type": "review",
      "name": "Review",
      "settings": [
        {
          "type": "range",
          "id": "rating",
          "min": 1,
          "max": 5,
          "step": 1,
          "default": 5,
          "label": "Rating"
        },
        {
          "type": "textarea",
          "id": "review_text",
          "default": "Great product and excellent service!",
          "label": "Review text"
        },
        {
          "type": "text",
          "id": "customer_name",
          "default": "John Doe",
          "label": "Customer name"
        },
        {
          "type": "text",
          "id": "customer_location",
          "default": "New York",
          "label": "Customer location"
        },
        {
          "type": "text",
          "id": "service_type",
          "label": "Service/Product type",
          "info": "Optional badge showing what product or service was purchased"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Customer Reviews",
      "blocks": [
        {
          "type": "review"
        },
        {
          "type": "review"
        },
        {
          "type": "review"
        }
      ]
    }
  ]
}
{% endschema %}
