{% comment %}
  File: sections/section-wholesale-benefits.liquid
  Preset: "Wholesale Program Benefits (PNG Icons)"
  Purpose: Headline + subheadline + 3 feature cards with PNG icon chip, pill, title, body and optional CTA
  Font consistency with theme typography
{% endcomment %}

<section class="wh-benefits-{{ section.id }}" aria-labelledby="wh-benefits-heading-{{ section.id }}" style="background: {{ section.settings.background_color }}; font-family: inherit;">
  <div class="whb{{ section.id }}-container" style="max-width: {{ section.settings.max_width }}px; margin: 0 auto; padding-top: {{ section.settings.padding_top }}px; padding-bottom: {{ section.settings.padding_bottom }}px;">

    {%- assign shadow = section.settings.shadow_intensity -%}

    <style>
      /* Keep capped cards centered */
      .whb{{ section.id }}-grid{
        justify-content: center;       /* centers items when they're narrower than the column */
        justify-items: center;         /* centers each item's box */
      }

      /* Mobile: cap card width and add side padding */
      @media (max-width: 767px){
        .whb{{ section.id }}-card{
          max-width: 520px;            /* tweak: 420â€“520px works well */
          width: 90%;
          margin-left: auto;
          margin-right: auto;
        }
        .whb{{ section.id }}-container{
          padding-left: 16px;          /* prevent card from kissing the viewport edge */
          padding-right: 16px;
        }
        .whb{{ section.id }}-subtitle{
          max-width: min(90vw, 36ch);  /* keep subheading from running full width */
        }
      }

      /* ===== Wholesale Benefits (scoped) ===== */
      .wh-benefits-{{ section.id }} * { 
        box-sizing: border-box; 
        font-family: inherit; /* Ensure all elements inherit theme fonts */
      }

      .pill-wrapper {
        display: flex;
        justify-content: center;
      }

      .whb{{ section.id }}-header {
        {% if section.settings.centered %} text-align: center; {% endif %}
        margin: 0 auto 32px;
        color: {{ section.settings.body_color | default: 'inherit' }};
        font-family: inherit;
      }
      .whb{{ section.id }}-title {
        color: {{ section.settings.heading_color | default: 'inherit' }};
        font-family: var(--font-heading-family, inherit); /* Use theme's heading font */
        font-weight: 800;
        letter-spacing: .01em;
        margin: 0 0 10px 0;
        line-height: 1.15;
        font-size: clamp(28px, 3.6vw, 42px);
      }
      .whb{{ section.id }}-subtitle {
        max-width: 720px;
        {% if section.settings.centered %} margin-left: auto; margin-right: auto; {% endif %}
        margin-top: 0;
        line-height: 1.55;
        opacity: .85;
        font-size: 16px;
        font-family: var(--font-body-family, inherit); /* Use theme's body font */
      }

      .whb{{ section.id }}-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: {{ section.settings.gap_mobile }}px;
      }
      @media (min-width: 768px) {
        .whb{{ section.id }}-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: {{ section.settings.gap_desktop | divided_by: 2.0 }}px;
        }
      }
      @media (min-width: 1024px) {
        .whb{{ section.id }}-grid {
          grid-template-columns: repeat(3, 1fr);
          gap: {{ section.settings.gap_desktop }}px;
        }
      }

      /* Card */
      .whb{{ section.id }}-card {
        background: {{ section.settings.card_bg }};
        border: 1px solid {{ section.settings.card_border }};
        border-radius: {{ section.settings.card_radius }}px;
        padding: 24px;
        color: {{ section.settings.body_color | default: 'inherit' }};
        font-family: inherit;
        transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
        {% if shadow == 'sm' %} box-shadow: 0 1px 2px rgba(16,24,40,.06); {% endif %}
        {% if shadow == 'md' %} box-shadow: 0 4px 12px rgba(16,24,40,.08); {% endif %}
        {% if shadow == 'lg' %} box-shadow: 0 8px 24px rgba(16,24,40,.10); {% endif %}
      }
      @media (min-width: 1024px) {
        .whb{{ section.id }}-card:hover {
          transform: translateY(-2px);
          {% if shadow == 'none' %} box-shadow: 0 1px 2px rgba(16,24,40,.06); {% endif %}
          {% if shadow == 'sm' %}   box-shadow: 0 4px 12px rgba(16,24,40,.08); {% endif %}
          {% if shadow == 'md' %}   box-shadow: 0 8px 24px rgba(16,24,40,.10); {% endif %}
          {% if shadow == 'lg' %}   box-shadow: 0 12px 32px rgba(16,24,40,.12); {% endif %}
        }
      }
      .whb{{ section.id }}-card:focus-within {
        outline: 2px solid currentColor;
        outline-offset: 2px;
      }

      /* Icon chip */
      .whb{{ section.id }}-chip {
        width: {{ section.settings.icon_circle_size }}px;
        height: {{ section.settings.icon_circle_size }}px;
        border-radius: 999px;
        background: {{ section.settings.icon_circle_bg }};
        margin: 6px auto 14px;
        display: grid;
        place-items: center;
        position: relative;
        {% if section.settings.icon_shadow %} box-shadow: 0 8px 22px rgba(46,139,87,.18); {% endif %}
      }
      .whb{{ section.id }}-chip img {
        max-width: {{ section.settings.icon_png_max_width }}px;
        max-height: {{ section.settings.icon_png_max_height }}px;
        display: block;
        margin: 0 auto;
        object-fit: contain;
        filter: none;
      }
      .whb{{ section.id }}-chip--fallback {
        width: 10px; height: 10px; background: rgba(255,255,255,.9); border-radius: 999px;
      }

      /* Pill */
      .whb{{ section.id }}-pill {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 6px 12px;
        border-radius: 999px;
        font-size: 13px;
        font-weight: 600;
        font-family: var(--font-body-family, inherit); /* Use theme's body font */
        letter-spacing: .03em;
        white-space: nowrap;
        border: 1px solid {{ section.settings.pill_border_color }};
        background: {{ section.settings.pill_bg_color }};
        color: {{ section.settings.pill_text_color }};
        {% if section.settings.pill_uppercase %} text-transform: uppercase; {% endif %}
        margin: 6px auto 10px;
      }

      /* Text */
      .whb{{ section.id }}-cardTitle {
        font-family: var(--font-heading-family, inherit); /* Use theme's heading font */
        font-weight: 800;
        font-size: 21px;
        line-height: 1.25;
        text-align: center;
        color: {{ section.settings.heading_color | default: 'inherit' }};
        margin: 6px 0 8px;
      }
      .whb{{ section.id }}-cardBody {
        font-family: var(--font-body-family, inherit); /* Use theme's body font */
        font-size: 16px;
        line-height: 1.55;
        opacity: .85;
        text-align: center;
        margin: 0 auto;
        max-width: 36ch;
      }

      /* CTA (optional) */
      .whb{{ section.id }}-cta {
        margin-top: 12px;
        text-align: center;
        font-family: inherit;
      }
      .whb{{ section.id }}-cta a {
        text-decoration: none;
        font-family: var(--font-body-family, inherit); /* Use theme's body font for links */
      }
      .whb{{ section.id }}-cta a:hover,
      .whb{{ section.id }}-cta a:focus {
        text-decoration: underline;
      }
      .whb{{ section.id }}-btn-outline {
        display: inline-block;
        padding: 8px 14px;
        border-radius: 10px;
        border: 1px solid currentColor;
        font-family: inherit;
      }

      .whb{{ section.id }}-footnote {
        text-align: center;
        margin-top: 22px;
        font-size: 14px;
        opacity: .8;
        font-family: var(--font-body-family, inherit); /* Use theme's body font */
      }

      /* Ensure specific elements use appropriate theme fonts */
      .wh-benefits-{{ section.id }} h2,
      .wh-benefits-{{ section.id }} h3,
      .wh-benefits-{{ section.id }} .whb{{ section.id }}-title,
      .wh-benefits-{{ section.id }} .whb{{ section.id }}-cardTitle {
        font-family: var(--font-heading-family, inherit);
      }

      .wh-benefits-{{ section.id }} p,
      .wh-benefits-{{ section.id }} div,
      .wh-benefits-{{ section.id }} span,
      .wh-benefits-{{ section.id }} a,
      .wh-benefits-{{ section.id }} .whb{{ section.id }}-subtitle,
      .wh-benefits-{{ section.id }} .whb{{ section.id }}-cardBody,
      .wh-benefits-{{ section.id }} .whb{{ section.id }}-pill,
      .wh-benefits-{{ section.id }} .whb{{ section.id }}-cta,
      .wh-benefits-{{ section.id }} .whb{{ section.id }}-footnote {
        font-family: var(--font-body-family, inherit);
      }

      /* Reduced motion */
      @media (prefers-reduced-motion: reduce) {
        .whb{{ section.id }}-card { transition: none; }
        .whb{{ section.id }}-card:hover { transform: none; }
      }
    </style>

    <header class="whb{{ section.id }}-header">
      <h2 id="wh-benefits-heading-{{ section.id }}" class="whb{{ section.id }}-title">
        {{ section.settings.heading | default: 'Why Choose Our Wholesale Program?' }}
      </h2>
      {%- if section.settings.subheading != blank -%}
        <p class="whb{{ section.id }}-subtitle">{{ section.settings.subheading }}</p>
      {%- endif -%}
    </header>

    <div class="whb{{ section.id }}-grid">
      {%- for block in section.blocks -%}
        <div class="whb{{ section.id }}-card" {{ block.shopify_attributes }}>
          {%- assign chip_bg = block.settings.icon_circle_bg_override | default: section.settings.icon_circle_bg -%}
          {%- assign chip_size = block.settings.icon_circle_size_override | default: section.settings.icon_circle_size -%}
          {%- assign max_w = block.settings.icon_png_max_width_override | default: section.settings.icon_png_max_width -%}
          {%- assign max_h = block.settings.icon_png_max_height_override | default: section.settings.icon_png_max_height -%}

          <div class="whb{{ section.id }}-chip"
               style="background: {{ chip_bg }}; width: {{ chip_size }}px; height: {{ chip_size }}px; {% if section.settings.icon_shadow %} box-shadow: 0 8px 22px rgba(46,139,87,.18); {% endif %}">
            {%- if block.settings.icon_image != blank -%}
              {%- assign icon = block.settings.icon_image -%}
              <img srcset="{{ icon | image_url: width: max_w | escape }}"
                   src="{{ icon | image_url: width: max_w }}"
                   alt=""
                   aria-hidden="true"
                   style="max-width: {{ max_w }}px; max-height: {{ max_h }}px;">
            {%- else -%}
              <span class="whb{{ section.id }}-chip--fallback" aria-hidden="true"></span>
            {%- endif -%}
          </div>

          {%- if block.settings.badge_text != blank -%}
            <div class="pill-wrapper">
              <div class="whb{{ section.id }}-pill">{{ block.settings.badge_text }}</div>
            </div>
          {%- endif -%}


          {%- if block.settings.title != blank -%}
            <h3 class="whb{{ section.id }}-cardTitle">{{ block.settings.title }}</h3>
          {%- endif -%}

          {%- if block.settings.body != blank -%}
            <p class="whb{{ section.id }}-cardBody">{{ block.settings.body }}</p>
          {%- endif -%}

          {%- if block.settings.cta_label != blank and block.settings.cta_url != blank -%}
            <div class="whb{{ section.id }}-cta">
              {%- if block.settings.cta_style == 'button-outline' -%}
                <a class="whb{{ section.id }}-btn-outline" href="{{ block.settings.cta_url }}">{{ block.settings.cta_label }}</a>
              {%- else -%}
                <a href="{{ block.settings.cta_url }}">{{ block.settings.cta_label }}</a>
              {%- endif -%}
            </div>
          {%- endif -%}
        </div>
      {%- endfor -%}
    </div>

    {%- if section.settings.footnote != blank -%}
      <div class="whb{{ section.id }}-footnote">{{ section.settings.footnote }}</div>
    {%- endif -%}
  </div>
</section>

{% schema %}
{
  "name": "Why Choose Us",
  "tag": "section",
  "class": "section-wholesale-benefits",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Why Choose Our Wholesale Program?" },
    { "type": "textarea", "id": "subheading", "label": "Subheading", "default": "Join thousands of businesses who trust us for their irrigation and water equipment needs" },

    { "type": "range", "id": "max_width", "label": "Max width (px)", "min": 900, "max": 1400, "step": 10, "default": 1200 },
    { "type": "range", "id": "padding_top", "label": "Padding top (px)", "min": 0, "max": 120, "step": 2, "default": 48 },
    { "type": "range", "id": "padding_bottom", "label": "Padding bottom (px)", "min": 0, "max": 120, "step": 2, "default": 56 },

    { "type": "color", "id": "background_color", "label": "Background color", "default": "#F8FAFC" },
    { "type": "color", "id": "heading_color", "label": "Heading color" },
    { "type": "color", "id": "body_color", "label": "Body text color" },

    { "type": "color", "id": "card_bg", "label": "Card background", "default": "#FFFFFF" },
    { "type": "color", "id": "card_border", "label": "Card border", "default": "#E6EEF5" },
    { "type": "range", "id": "card_radius", "label": "Card corner radius (px)", "min": 0, "max": 24, "step": 1, "default": 12 },

    {
      "type": "select",
      "id": "shadow_intensity",
      "label": "Shadow intensity",
      "default": "md",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "sm", "label": "Small" },
        { "value": "md", "label": "Medium" },
        { "value": "lg", "label": "Large" }
      ]
    },

    { "type": "range", "id": "gap_desktop", "label": "Grid gap (desktop, px)", "min": 16, "max": 48, "step": 1, "default": 24 },
    { "type": "range", "id": "gap_mobile",  "label": "Grid gap (mobile, px)",  "min": 8,  "max": 24, "step": 1, "default": 14 },

    { "type": "color", "id": "icon_circle_bg", "label": "Icon circle background", "default": "#2E8B57" },
    { "type": "range", "id": "icon_circle_size", "label": "Icon circle size (px)", "min": 56, "max": 112, "step": 2, "default": 80 },
    { "type": "range", "id": "icon_png_max_width", "label": "Icon PNG max width (px)", "min": 16, "max": 64, "step": 1, "default": 32 },
    { "type": "range", "id": "icon_png_max_height", "label": "Icon PNG max height (px)", "min": 16, "max": 64, "step": 1, "default": 32 },
    { "type": "checkbox", "id": "icon_shadow", "label": "Icon circle glow", "default": true },

    { "type": "color", "id": "pill_text_color", "label": "Pill text color", "default": "#154C2E" },
    { "type": "color", "id": "pill_bg_color", "label": "Pill background", "default": "#E7F6EF" },
    { "type": "color", "id": "pill_border_color", "label": "Pill border", "default": "#CFEBDD" },
    { "type": "checkbox", "id": "pill_uppercase", "label": "Uppercase pill text", "default": false },

    { "type": "checkbox", "id": "centered", "label": "Center heading/subheading", "default": true },
    { "type": "text", "id": "footnote", "label": "Footnote (optional)" }
  ],
  "blocks": [
    {
      "type": "feature_card",
      "name": "Feature card",
      "settings": [
        { "type": "text", "id": "title", "label": "Title", "default": "Card title" },
        { "type": "text", "id": "badge_text", "label": "Pill text" },
        { "type": "textarea", "id": "body", "label": "Body" },

        { "type": "image_picker", "id": "icon_image", "label": "Icon PNG (transparent recommended)" },

        { "type": "color", "id": "icon_circle_bg_override", "label": "Icon circle background (override)" },
        { "type": "range", "id": "icon_circle_size_override", "label": "Icon circle size (override, px)", "min": 56, "max": 112, "step": 2, "default": 80 },
        { "type": "range", "id": "icon_png_max_width_override", "label": "Icon PNG max width (override, px)", "min": 16, "max": 64, "step": 1, "default": 32 },
        { "type": "range", "id": "icon_png_max_height_override", "label": "Icon PNG max height (override, px)", "min": 16, "max": 64, "step": 1, "default": 32 },

        { "type": "text", "id": "cta_label", "label": "CTA label (optional)" },
        { "type": "url",  "id": "cta_url",   "label": "CTA link (optional)" },
        {
          "type": "select",
          "id": "cta_style",
          "label": "CTA style",
          "default": "link",
          "options": [
            { "value": "link", "label": "Text link" },
            { "value": "button-outline", "label": "Button (outline)" }
          ]
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Why Choose Us",
      "blocks": [
        {
          "type": "feature_card",
          "settings": {
            "badge_text": "30% Savings",
            "title": "Save up to 30% on bulk orders",
            "body": "Significant discounts on large quantity purchases across all product categories"
          }
        },
        {
          "type": "feature_card",
          "settings": {
            "badge_text": "Exclusive Access",
            "title": "Direct access to top irrigation brands",
            "body": "Exclusive access to premium manufacturers not available to retail customers"
          }
        },
        {
          "type": "feature_card",
          "settings": {
            "badge_text": "Priority Support",
            "title": "Dedicated wholesale support",
            "body": "Personal account manager and priority customer service for all your needs"
          }
        }
      ]
    }
  ]
}
{% endschema %}